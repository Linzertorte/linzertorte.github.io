<!DOCTYPE html>
<html>
<head>
<title>Langenscheidt</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<style>
    body {
        margin-left:20%;
        margin-right:20%;
    }
    img {
        width:100%;
    }
    #page_num{
            display: none;
    }
    @media only screen and (max-width: 768px) {
        body {
            padding-left:8px;
            margin-left:0%;
            margin-right:0%;
        }
        img {
            width:100%;
        }
        #page_num{
            display: inline;
        }
    }
    @media only screen and (min-device-width: 768px) and (max-device-width: 1024px) {
        body {
            margin-left:10%;
            margin-right:10%;
        }
        img {
            width:100%;
        }
    }
</style>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>
<body>
<h1>Langenscheidt</h1>
<input type="text" id="word" name="word"><button type="button" id="btn">Search</button>
<div>
<button type="button" id="prev">Prev</button>
<button type="button" id="next">Next</button>
<span id="page_num"></span>
</div>
<div id="page"></div>
</body>
<script charset="utf-8">
word_list = `
A
abändern
abartig
Abbitte
abbrühen
abdrücken
abends
abfahren
abfeilen
Abfuhr
`

var cur_page = 0;
function clean_word(word) {
    word = word.replaceAll("à", "a");
    word = word.replaceAll("é", "e");

    word = word.replaceAll("Ä","a");
    word = word.replaceAll("Ö","o");
    word = word.replaceAll("Ü","u");

    word = word.replaceAll("ä","a");
    word = word.replaceAll("ö","o");
    word = word.replaceAll("ü","u");

    word = word.replaceAll("ẞ","ss");
    
    word = word.toLowerCase();

    word = word.replace(/^\s+|\s+$/g,'')

    word = word.replaceAll("-", "");
    word = word.replaceAll(" ", "");
    return word;
}

var words = word_list.split("\n").filter((word) => word.length > 0);;
//console.log(words);
const zeroPad = (num, places) => String(num).padStart(places, '0')

var pic_prefix = "https://langenscheidt.s3.amazonaws.com/langenscheidt-";
//pic_prefix = "langenscheidts-";
if(!$("#page_num").is(":hidden")) {
    pic_prefix = "https://langenscheidt.s3.amazonaws.com/m-langenscheidt-";
}

$("#btn").on("click", function (e) {
    var word =  document.getElementById("word").value;
    word = clean_word(word);
    var i = 0;
    for(i = 0; i < words.length; i += 1) {
        words[i] = clean_word(words[i]);
    }
    i = 0
    while(words.length && (words[i]=='$' || words[i]<=word)) {
        i+=1;
    }
    if(i>0) i-=1;
    while (i>=0 && words[i]=='$'){
        i-=1;
    }
    cur_page = i;
    var html = "<img src=\""+pic_prefix+zeroPad(cur_page + 1,4)+".png\">"
    $("#page").html(html)
    $("#page_num").text(cur_page + 1);
});
$("#prev").on("click", function (e) {
    if(cur_page > 0) {
        cur_page -= 1;
        var html = "<img src=\""+pic_prefix+zeroPad(cur_page + 1,4)+".png\">"
        $("#page").html(html)
        $("#page_num").text(cur_page + 1);
    }
});
$("#next").on("click", function (e) {
    if(cur_page < 2178 - 1){
        cur_page += 1;
        var html = "<img src=\""+pic_prefix+zeroPad(cur_page + 1,4)+".png\">"
        $("#page").html(html)
        $("#page_num").text(cur_page + 1);
    }
});
</script>
</html>
